"""The Output_Shape module contains details on the pyDO3SE outputs."""

import numpy as np
from pyDO3SE.util.Objects import Field
from typing import Tuple, List


class OutputData:
    # output data shape (x, y, t)
    output_shape: Tuple[int, int, int]
    # dictionary of key: str and values: data with shape(x, y ,t) where each element is a dict
    full_output_data: dict
    lat_data: np.ndarray
    lon_data: np.ndarray
    time_data: np.ndarray
    output_fields: List[str]

    def __init__(
        self,
        output_shape: Tuple[int, int, int],
        full_output_data: dict,
        output_fields: List[str],
        lat_data: np.ndarray,
        lon_data: np.ndarray,
        time_data: np.ndarray,
    ):
        self.time_data = time_data
        self.output_shape = output_shape
        self.lat_data = lat_data
        self.lon_data = lon_data
        self.output_fields = output_fields
        self.full_output_data = full_output_data


# TODO: Work out how to document the below for autodoc
# NOTE: Commented lines are not implemented
#: Output Fields
output_fields: list[Field] = [
    # Inputs
    Field("row_index", int, "Row Index", "", "RowIndex"),
    #     Field('yr', int, 'Year', '', 'Year'),
    #     Field('mm', int, 'Month', '', 'Month'),
    #     Field('mdd', int, 'Month day', '', 'Day of month'),
    Field("dd_e", int, "Day from external data", "", "Day of year"),
    Field("td", float, "Td", "C", "Thermal Time"),
    Field("hr", int, "Hour", "", "Hour of day (0 to 23)"),
    Field("ts_c", float, "Ts_C", "C", "Temperature (Ts_C, Celcius)"),
    Field("rh", float, "Rh", "1", "Relative Humidity"),
    Field("vpd", float, "VPD", "kPa", "Vapour Pressure Deficit (VPD, kPa)"),
    Field("uh_zr", float, "uh_zR", "m/s", "Measured wind speed (uh_zR, m/s)"),
    Field("precip", float, "precip", "mm", "Precipitation (precip, mm)"),
    Field("precip_acc", float, "precip_acc", "mm", "Accumulated precipitation (precip_acc, m)"),
    Field("p", float, "P", "kPa", "Pressure (P, kPa)"),
    Field("o3_ppb_zr", float, "O3_zR", "ppb", "Measured O3 density (O3_zR, ppb)"),
    Field("co2", float, "CO2", "ppm", "Ambient CO2 concentration (CO2, ppm)"),
    Field("hd", float, "Hd", "Wh/m^2", "Sensible heat flux (Hd, Wh/m\u00b2)"),
    Field("r", float, "R", "Wh/m^2", "Global radiation (R, Wh/m\u00b2)"),
    Field("par", float, "PAR", "umol/m^2/s", "Photosynthetically active radiation (PAR, umol/m\u00b2/s)"),
    Field("swc", float, "SWC", "%", "Soil water content (SWP, %)"),
    # Calculated variables
    Field("dd", int, "Day", "", "Day of year"),
    Field("dd_offset", int, "Day offset", "", "Day of year offset"),
    Field("PARsun", float, "PARsun", "W m-2", "PAR received by sunlit leaves", per_iL=True),
    Field("PARshade", float, "PARshade", "W m-2", "PAR received by shaded leaves", per_iL=True),
    Field("Tleaf_C", float, "Tleaf_C", "C", "Leaf Temperature (Celsius)"),
    Field("ustar", float, "u*", "m/s", "Friction velocity (u*, m/s)"),
    Field("ustar_ref", float, "uref*", "m/s", "Friction velocity above ref canopy (u*, m/s)"),
    Field("canopy_height", float, "h", "m", "Overall canopy height"),
    Field("layer_height", float, "il_h", "m", "Layer height"),
    Field("u_i", float, "uh_i", "m/s", "Wind speed at Decoupled Reference Height(izr) (uh_i, m/s)"),
    Field("micro_u", float, "micro_u", "m/s", "Wind speed at target canopy (uh, m/s)", per_iL=True),
    Field("micro_O3", float, "micro_O3", "ppb", "Ozone concentration at micro meteorological layer height", per_iL=True, per_iCH=True),
    Field("ground_u", float, "ground_u", "m/s", "Wind speed below canopy (uh, m/s)"),
    Field("ground_O3", float, "ground_O3", "ppb", "Ozone concentration below canopy"),
    Field("canopy_top_o3", float, "canopy_top_o3", "ppb", "Ozone concentration at top of canopy"),
    Field("rn", float, "Rn", "MJ/m^2", "Net radiation (Rn, MJ/m\u00b2)"),
    #     Field('rn_w', float, 'Rn_W', 'Wh/m^2', u'Net radiation (Rn, Wh/m\u00b2)'),
    Field("ra", float, "Ra", "s/m", "Aerodynamic resistance (Ra, s/m)"),
    Field("rb", float, "Rb", "s/m", "Boundary layer resistance (Rb, s/m)"),
    Field("rsur", float, "Rsur", "s/m", "Surface resistance (Rsur, s/m)"),
    Field("rinc", float, "Rinc", "s/m", "In-canopy resistance (Rinc, s/m)"),
    Field("rext", float, "Rext", "s/m", "External plant cuticle resistance (s/m)"),
    Field("rsto_c", float, "Rsto_c", "s/m", "Mean stomatal resistance (Rsto, s/m)"),
    Field("rsto_h2o", float, "Rsto_H2O", "s/m", "Mean H2O stomatal resistance (Rsto, s/m)"),
    Field("gsto", float, "Gsto", "mmol/m^2/s", "Mean stomatal conductance (Gsto, mmol/m\u00b2/s)"),
    Field("gsto_bulk", float, "Gsto_Bulk", "mmol/m^2/s", "Bulk stomatal conductance (Gsto Bulk, mmol/m\u00b2/s)"),
    Field(
        "gsto_canopy",
        float,
        "Gsto_canopy",
        "mmol/m^2/s",
        "Bulk Canopy stomatal conductance (Gsto Bulk, mmol/m\u00b2/s)",
    ),
    Field("R_d", float, "R_d", "umol CO2 m-2 PLA s-1", "Flag leaf dark respiration rate"),
    Field("R_dc", float, "R_dc", "umol CO2 m-2 PLA s-1", "Canopy dark respiration rate"),
    Field("A_n", float, "A_n", "umol CO2 m-2 PLA s-1", "Net CO2 assimilation rate"),
    Field("A_n_sunlit", float, "A_n_sunlit", "umol CO2 m-2 PLA s-1", "Net CO2 assimilation rate sunlit component"),
    Field("A_j", float, "A_j", "umol CO2 m-2 PLA s-1", "limited assimilation rate (A_q in paper) "),
    Field("A_c", float, "A_c", "umol CO2 m-2 PLA s-1", "Rubisco activity limited rate of photosynthesis"),
    Field("A_p", float, "A_p", "umol CO2 m-2 PLA s-1", "Triose phosphate utilisation limited assimilation rate"),
    Field("A_n_canopy", float, "A_n_canopy", "umol CO2 m-2 PLA s-1", "Net CO2 assimilation rate upscaled to canopy"),
    Field("A_n_limit_factor", str, "A_n_limit_factor", "A_c/A_p/A_j", "Net CO2 assimilation rate limiting factor"),
    #     Field('A_n_acc', float, 'A_n_acc', 'umol CO2 m-2 PLA s-1', 'Accumulated Net CO2 assimilation'),
    Field("c_i", float, "c_i", "micromol/mol", "CO2 concentration inside stomata"),
    Field("gpp", float, "GPP", "kg C m^-2 hr^-1", "Gross primary productivity"),
    Field("npp", float, "NPP", "kg C m^-2 hr^-1", "Net primary productivity"),
    Field("npp_acc", float, "NPP_Acc", "kg C m^-2 day^-1", "Accumulated daily Net primary productivity"),
    Field("R_pm", float, "Maintainance Respiration", "kg C m^-2 hr^-1", "Maintainance Respiration"),
    Field("R_pg", float, "Growth Respiration", "kg C m^-2 hr^-1", "Growth Respiration"),
    Field("c_root", float, "c_root", "kg C m^-2", "Root carbon pool"),
    Field("c_stem", float, "c_stem", "kg C m^-2", "stem carbon pool"),
    Field("c_leaf", float, "c_leaf", "kg C m^-2", "leaf carbon pool"),
    Field("c_lbrn", float, "c_lbrn", "kg C m^-2", "brown leaf carbon pool"),
    Field("c_harv", float, "c_harv", "kg C m^-2", "harvest carbon pool"),
    Field("c_resv", float, "c_resv", "kg C m^-2", "Reserve carbon pool"),
    Field("p_root", float, "p_root", "%", "Root carbon partition fraction"),
    Field("p_stem", float, "p_stem", "%", "stem carbon partition fraction"),
    Field("p_leaf", float, "p_leaf", "%", "leaf carbon partition fraction"),
    Field("p_harv", float, "p_harv", "%", "harvest carbon partition fraction"),
    Field("c_root", float, "c_root", "kg C m^-2", "Root carbon pool"),
    Field("stem_dm", float, "stem_dm", "?", "stem_dm"),
    Field("leaf_dm", float, "leaf_dm", "?", "leaf_dm"),
    Field("lbrn_dm", float, "lbrn_dm", "?", "lbrn_dm"),
    Field("total_leaf_dm", float, "total_leaf_dm", "?", "total_leaf_dm"),
    Field("straw_dm", float, "straw_dm", "?", "straw_dm"),
    Field("ear_dm", float, "ear_dm", "?", "ear_dm"),
    Field("aboveground_dm", float, "aboveground_dm", "?", "aboveground_dm"),
    Field("belowground_dm", float, "belowground_dm", "?", "belowground_dm"),
    Field("grain_dm", float, "grain_dm", "?", "grain_dm"),
    Field("harvest_index", float, "harvest_index", "fraction", "harvest_index"),
    #     TODO: Should change name of yield_ha to g/m^2
    Field("yield_ha", float, "yield_ha", "g/m^2", "yield_ha"),
    Field("rsto_l", float, "Rsto_l", "s/m", "Leaf stomatal resistance (Rsto_l, s/m)"),
    Field("rb_l", float, "Rb_l", "s/m", "Leaf Boundary layer resistance (Rb, s/m)"),
    Field("gsto_l", float, "Gsto_l", "mmol/m^2/s", "Leaf stomatal conductance (Gsto_l, mmol/m\u00b2/s)"),
    Field(
        "gsto_l_sunlit",
        float,
        "Gsto_l_sunlit",
        "mmol/m^2/s",
        "Leaf stomatal conductance sunlit only(Gsto_l, mmol/m\u00b2/s)",
    ),
    #     Field('rsto_c', float, 'Rsto_c', 's/m',
    #           'Canopy stomatal resistance (Rsto_c, s/m)'),
    #     Field('rgs', float, 'Rgs', 's/m', 'Ground surface resistance (Rgs, s/m)'),
    Field("gsto_l_bulk", float, "Gsto_l_Bulk", "mmol/m^2/s", "leaf stomatal conductance (Leaf Bulk, mmol/m\u00b2/s)"),
    Field("canopy_vd", float, "Vd", "m/s", "Deposition velocity (Vd, m/s)"),
    Field("o3_ppb_i", float, "O350", "ppb", "Ozone concentration at 50m (O350, ppb)"),
    Field("o3_ppb", float, "O3", "ppb", "Ozone concentration at canopy (O3, ppb)"),
    Field("o3_nmol_m3", float, "O3", "nmol/m^3", "Ozone concentration at canopy (O3, nmol/m\u00b3)"),
    Field("fst", float, "Fst", "nmol/m^2/s", "Upper leaf stomatal O3 flux (Fst, nmol/m\u00b2/s)"),
    Field(
        "fst_sun", float, "Fst Sun", "nmol/m^2/s", "Upper leaf stomatal O3 flux for sunlit leaves (Fst, nmol/m\u00b2/s)"
    ),
    Field("fst_canopy", float, "Fst Canopy", "nmol/m^2/s", "Canopy stomatal O3 flux (Fst, nmol/m\u00b2/s)"),
    Field(
        "fst_acc", float, "Fst_acc", "nmol/m^2/s", "Accumulated Upper leaf stomatal O3 flux (Fst_acc, nmol/m\u00b2/s)"
    ),
    Field(
        "fst_acc_day",
        float,
        "Fst_acc",
        "nmol/m^2/s",
        "Daily Accumulated Upper leaf stomatal O3 flux (Fst_acc, nmol/m\u00b2/s)",
    ),
    Field("pod0", float, "POD0", "mmol/m^2 PLA", "Accumulated Fst (POD0, mmol/m\u00b2 PLA)"),
    Field("pody", float, "PODY", "mmol/m^2 PLA", "Accumulated Fst over threshold Y (PODY, mmol/m\u00b2 PLA)"),
    Field(
        "pody_sun",
        float,
        "PODY Sunlit",
        "mmol/m^2 PLA",
        "Accumulated Fst over threshold Y for sunlit leaves (PODY, mmol/m\u00b2 PLA)",
    ),
    Field("ftot", float, "Ftot", "nmol/m^2/s", "Total ozone flux (Ftot, nmol/m\u00b2/s)"),
    #     Field('ot40', float, 'OT40', 'ppm', 'Ozone over 40 ppb (OT40, ppm)'),
    #     Field('aot40', float, 'AOT40', 'ppm',
    #     'Accumulated OT40 over growth period (AOT40, ppm)'),
    Field("canopy_lai", float, "Canopy LAI", "", "Leaf Area Index (LAI, m\u00b2/m\u00b2)"),
    Field("canopy_lai_brown", float, "Canopy LAI brown leaf", "", "Brown Leaf Area Index (brown_LAI, m\u00b2/m\u00b2)"),
    Field("component_LAI", float, "LAI_c", "", "Component Leaf Area Index (LAI, m\u00b2/m\u00b2)"),
    Field("layer_lai", float, "LAI_layer", "", "layer Leaf Area Index (LAI, m\u00b2/m\u00b2)"),
    Field("LAI_flag", float, "LAI_flag", "", "Flag leaf Leaf Area Index (LAI, m\u00b2/m\u00b2)"),
    Field("fLAI", float, "fLAI", "", "Fraction of each layer that is this leaf population (Sums up to 1.0)"),
    Field("canopy_sai", float, "Canopy SAI", "", "Stand Area Index (SAI, m\u00b2/m\u00b2)"),
    Field("pet", float, "PEt", "m/day", "Potential plant transpiration (PEt, m/day)"),
    Field("pet_acc", float, "PEt_acc", "m/day", "Accumulated Potential plant transpiration (PEt, m/day)"),
    Field("et", float, "Et", "m", "Plant traspiration (Et, m)"),
    Field("ei", float, "Ei", "m", "Evaporation of intercepted precipitation (Ei, m)"),
    Field("es", float, "Es", "m", "Soil evaporation (Es, m)"),
    Field("eat_acc", float, "EAt_acc", "m", "Plant evapotranspiration daily accumulation (Eat, m)"),
    Field("et_acc", float, "Et_acc", "m", "Plant traspiration daily accumulation (Et, m)"),
    Field("ei_acc", float, "Ei_acc", "m", "Evaporation of intercepted precipitation daily accumulation (Ei, m)"),
    Field("es_acc", float, "Es_acc", "m", "Soil evaporation daily accumulation (Es, m)"),
    # Replaced with es_acc etc. Note different type of accumulation used
    #     Field('et_dd', float, 'Et_dd', 'm/day', 'Plant traspiration (Et, m/day)'),
    #     Field('ei_dd', float, 'Ei_dd', 'm/day',
    #           'Evaporation of intercepted precipitation (Ei, m/day)'),
    #     Field('es_dd', float, 'Es_dd', 'm/day', 'Soil evaporation (Es, m/day)'),
    Field("sn", float, "Sn", "m^3/m^3", "Soil water content (Sn, m\u00b3/m\u00b3)"),
    #     Field('per_vol', float, 'per_vol',
    #           '%', 'Volumetric water content (per_vol, %)'),
    Field("smd", float, "SMD", "m", "Soil moisture deficit (SMD, m)"),
    Field("swp", float, "SWP", "MPa", "Soil water potential (SWP, MPa)"),
    #     Field('lwp', float, 'LWP', 'MPa', 'Leaf water potential (LWP, MPa)'),
    Field("asw", float, "ASW", "m^3/m^3", "Available soil water (ASW, m\u00b3/m\u00b3)"),
    #     Field('sn_meas', float, 'Sn_meas', 'm^3/m^3',
    #           u'Soil water content at measurement depth (Sn_meas, m\u00b3/m\u00b3)'),
    #     Field('swp_meas', float, 'SWP_meas', 'MPa',
    #           'Soil water potential at measurement depth (SWP_meas, MPa)'),
    #     Field('smd_meas', float, 'SMD_meas', 'm',
    #           'Soil moisture deficit at measurement depth (SMD_meas, m)'),
    Field("f_phen", float, "f_phen", "", "Phenology effect on stomatal conductance (f_phen, fraction)"),
    Field(
        "leaf_f_phen", float, "leaf_f_phen", "", "Phenology effect on leaf stomatal conductance (leaf_f_phen, fraction)"
    ),
    Field("f_light", float, "f_light", "", "Irradiance effect on stomatal conductance (f_light, fraction)"),
    Field(
        "leaf_f_light",
        float,
        "leaf_f_light",
        "",
        "Irradiance effect on leaf stomatal conductance (leaf_f_light, fraction)",
    ),
    Field("f_temp", float, "f_temp", "", "Temperature effect on stomatal conductance (f_temp, fraction)"),
    Field("f_VPD", float, "f_VPD", "", "VPD effect on stomatal conductance (f_VPD, fraction)"),
    Field("f_SW", float, "f_SW", "", "Soil water effect on stomatal conductance (f_SW, fraction)"),
    Field("f_O3", float, "f_O3", "", "O3 effect on stomatal conductance (f_O3, fraction)"),
    Field("V_cmax_25", float, "V_cmax_25", "", "Maximum catalytic rate at 25 degrees [umol m-2 s-1]"),
    Field("J_max_25", float, "J_max_25", "", "Maximum rate of electron transport at 25 degrees [umol m-2 s-1]"),
    Field("V_cmax", float, "V_cmax", "", "catalytic rate [umol m-2 s-1]"),
    Field("J_max", float, "J_max", "", "rate of electron transport [umol m-2 s-1]"),
    Field("f_LS", float, "f_LS", "", "decline in Rubisco limited rate of photosynthesis in senescing leaves [0-1]"),
    Field("f_LA", float, "f_LA", "", "Leaf repair capacity age factor. Between 0-1 over t_lma [dimensionless]"),
    # Phenology and ozone impact
    Field("phenology_stage", str, "phenology_stage", "", "phenology_stage"),
    Field("leaf_phenology_stage", str, "leaf_phenology_stage", "", "leaf_phenology_stage"),
    Field("td_v", float, "td_v", "%", "Thermal time vernalised"),
    Field("Vf", float, "Vf", "%", "Vernalisation Factor"),
    Field("V_acc", float, "V_acc", "", "Vernalisation accumulation"),
    Field("V_tot", float, "V_tot", "", "Total Vernalisation (Daily)"),
    Field("V_pos", float, "V_pos", "", "Positive Vernalisation (Daily)"),
    Field("V_neg", float, "V_neg", "", "Positive Vernalisation (Daily)"),
    Field("td_dd", float, "Td_dd", "C", "Thermal Time difference since plant emergence"),
    Field("td_dd_flag", float, "Td_dd_flag", "C", "Thermal Time difference since flag emergence"),
    Field("fO3_d", float, "fO3_d", "", "Ozone damage"),
    Field("fO3_h", float, "fO3_h", "", "Ozone damage"),
    Field("fO3_l", float, "fO3_l", "", "Ozone damage"),
    Field("t_lep_limited", float, "t_lep_limited", "", "t_lep with ozone impact"),
    Field("t_lse_limited", float, "t_lse_limited", "", "t_lse with ozone impact"),
    # Debug variables
    Field("photoperiod", float, "photoperiod", "", "The day length (Weir et al 1984)"),
    Field("photoperiod_factor", float, "photoperiod_factor", "", "The day length factor (Weir et al 1984)"),
    Field("dvi", float, "dvi", "", "Development Index [Dimensionless] (Osborne 2015)"),
    Field("t_eff", float, "t_eff", "DegC", "Effective Temperature for td calcs"),
    #     Field('gsto_final', float, 'gsto_final',
    #           '', '[DEBUG] Photosynthetic Gsto (base)'),
    #     Field('pngsto_l', float, 'Pn Gsto_l',
    #           '', '[DEBUG] Photosynthetic Gsto (leaf)'),
    #     Field('pngsto', float, 'Pn Gsto', '', '[DEBUG] Photosynthetic Gsto (mean)'),
    #     Field('pngsto_c', float, 'Pn Gsto_c',
    #           '', '[DEBUG] Photosynthetic Gsto (canopy)'),
    #     Field('pngsto_pet', float, 'Pn Gsto_PEt',
    #           '', '[DEBUG] Photosynthetic Gsto (PEt)'),
    #     Field('pngsto_an', float, 'Pn_Gsto_An', '', '[DEBUG] Net assimilation'),
    Field("LAIsunfrac", float, "LAIsunfrac", "", "Fraction of sunlit/shaded leaves. 1.0 is fully sunlit"),
    Field("total_emerged_leaves", float, "iP_emerged", "", "Number of leaf populations that have emerged"),
    Field(
        "growing_populations", float, "iP_growing", "", "boolean matrix of each leaf population where true if growing"
    ),
    Field("leaf_pop_distribution", float, "iP_distribution", "%", "LAI in each leaf population per layer (nL, nP)"),
]

# TODO: Add per population fields
per_population_fields = [""]

output_fields_map = {v.id: v for v in output_fields}

#: These are the default full set of output fields when performing grid run
default_grid_output_fields = [
    "dd",
    "dd_e",
    "hr",
    "ts_c",
    "rh",
    "par",
    "p",
    "uh_zr",
    "precip",
    "o3_ppb_zr",
    "co2",
    "hd",
    "r",
    "rn",
    "vpd",
    "td",
    "td_v",
    "photoperiod_factor",
    "Vf",
    "V_acc",
    "V_pos",
    "V_neg",
    "canopy_lai",
    "canopy_lai_brown",
    "canopy_sai",
    "dvi",
    "photoperiod",
    "o3_ppb_i",
    "canopy_vd",
    "u_i",
    "Tleaf_C",
    "ustar",
    "canopy_height",
    "micro_u",
    "micro_O3",
    "canopy_top_o3",
    "PARsun",
    "PARshade",
    "o3_ppb",
    "o3_nmol_m3",
    "layer_height",
    "LAI_flag",
    "A_n",
    "A_n_sunlit",
    "fst",
    "fst_canopy",
    "fst_acc",
    "fst_acc_day",
    # 'fst_acc_day_prev',
    "rext",
    "rsto_l",
    "rb_l",
    "gsto_l",
    "gsto_l_sunlit",
    "gsto_l_bulk",
    "gsto",
    "gsto_bulk",
    "gsto_canopy",
    "A_n_canopy",
    "c_root",
    "c_stem",
    "c_leaf",
    "c_lbrn",
    "c_harv",
    "c_resv",
    "grain_dm",
    "harvest_index",
    "yield_ha",
    "gpp",
    "npp",
    "npp_acc",
    "R_pm",
    "R_pg",
    "fO3_h",
    "fO3_d",
    "fO3_l",
    "f_LS",
    "f_LA",
    "c_i",
    "td_dd",
    "td_dd_flag",
    "pody",
    "pod0",
    "precip_acc",
    "swp",
    "asw",
    "smd",
    "sn",
    "ei",
    "et",
    "pet",
    "es",
    "ei_acc",
    "eat_acc",
    "et_acc",
    "pet_acc",
    "es_acc",
    "f_phen",
    "leaf_f_phen",
    "f_light",
    "leaf_f_light",
    "f_temp",
    "f_VPD",
    "f_SW",
    "f_O3",
    "rsto_c",
    "ra",
    "rb",
    "rsur",
    "rinc",
    "V_cmax_25",
    "J_max_25",
    "LAIsunfrac",
    "component_LAI",
    "V_cmax",
    "J_max",
    "R_d",
    "R_dc",
    "total_emerged_leaves",
    "growing_populations",
    "layer_lai",
    "fLAI",
    "t_eff",
]

#: These are the default full set of output fields when performing single point run
default_output_fields = [
    "dd",
    "dd_e",
    "hr",
    "ts_c",
    "rh",
    "par",
    "p",
    "uh_zr",
    "precip",
    "o3_ppb_zr",
    "co2",
    "hd",
    "r",
    "rn",
    "vpd",
    "td",
    "td_v",
    "photoperiod_factor",
    "Vf",
    "V_acc",
    "V_pos",
    "V_neg",
    "canopy_lai",
    "canopy_lai_brown",
    "canopy_sai",
    "lai",
    "lai_brown",
    "dvi",
    "photoperiod",
    "o3_ppb_i",
    "canopy_vd",
    "u_i",
    "Tleaf_C",
    "ustar",
    "ustar_ref",
    "canopy_height",
    "micro_u",
    "micro_O3",
    "ground_u",
    "ground_O3",
    "canopy_top_o3",
    "PARsun",
    "PARshade",
    "o3_ppb",
    "o3_nmol_m3",
    "layer_height",
    "LAI_flag",
    "A_n",
    "A_n_sunlit",
    "A_n_limit_factor",
    "fst",
    "fst_sun",
    "fst_canopy",
    "fst_acc",
    "fst_acc_day",
    # 'fst_acc_day_prev',
    "rext",
    "rsto_l",
    "rb_l",
    "gsto_l",
    "gsto_l_sunlit",
    "gsto_l_bulk",
    "gsto",
    "gsto_bulk",
    "gsto_canopy",
    "A_n_canopy",
    "c_root",
    "c_stem",
    "c_leaf",
    "c_lbrn",
    "c_harv",
    "c_resv",
    "p_root",
    "p_stem",
    "p_leaf",
    "p_harv",
    "stem_dm",
    "leaf_dm",
    "lbrn_dm",
    "total_leaf_dm",
    "straw_dm",
    "ear_dm",
    "aboveground_dm",
    "belowground_dm",
    "grain_dm",
    "harvest_index",
    "yield_ha",
    "gpp",
    "npp",
    "npp_acc",
    "R_pm",
    "R_pg",
    "fO3_h",
    "fO3_d",
    "fO3_l",
    "f_LS",
    "f_LA",
    "c_i",
    "td_dd",
    "td_dd_flag",
    "pody",
    "pody_sun",
    "pod0",
    "precip_acc",
    "swp",
    "asw",
    "smd",
    "sn",
    "ei",
    "et",
    "pet",
    "es",
    "ei_acc",
    "eat_acc",
    "et_acc",
    "pet_acc",
    "es_acc",
    "f_phen",
    "leaf_f_phen",
    "f_light",
    "leaf_f_light",
    "f_temp",
    "f_VPD",
    "f_SW",
    "f_O3",
    "rsto_c",
    "ra",
    "rb",
    "rsur",
    "rinc",
    "rsto_h2o",
    "V_cmax_25",
    "J_max_25",
    "LAIsunfrac",
    "component_LAI",
    "V_cmax",
    "J_max",
    "R_d",
    "R_dc",
    "total_emerged_leaves",
    "leaf_phenology_stage",
    "leaf_pop_distribution",
    "phenology_stage",
    "growing_populations",
    "layer_lai",
    "layer_lai_brown",
    "fLAI",
    "t_eff",
]

if __name__ == "__main__":
    print(output_fields_map["gsto"])

